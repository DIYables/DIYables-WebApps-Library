#ifndef WEB_JOYSTICK_H
#define WEB_JOYSTICK_H

const char web_joystick_html[] PROGMEM = R"RAWSTRING(<!DOCTYPE html><html><head><title>Web Joystick Control - DIYables WebApp</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta charset="utf-8"><link rel="icon" href="https://diyables.io/images/page/diyables.svg"><style>*{margin:0;padding:0;box-sizing:border-box;}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:white;min-height:100vh;padding:0 0 40px 0;margin:0;display:flex;flex-direction:column;}.a{width:100%;flex:1;margin:0 auto;max-width:1200px;background:white;border-radius:0;box-shadow:none;display:flex;flex-direction:column;}.b{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:25px;text-align:center;position:relative;}.b h1{font-size:2.0em;margin-bottom:5px;}.b p{font-size:1.0em;opacity:0.9;}.c{background:#f8f9fa;padding:10px 20px;border-bottom:1px solid #e9ecef;display:flex;justify-content:space-between;align-items:center;}.d{color:#667eea;text-decoration:none;font-size:1.1em;font-weight:bold;transition:all 0.3s;padding:8px 12px;border-radius:6px;background:rgba(102,126,234,0.1);}.d:hover{background:rgba(102,126,234,0.2);transform:scale(1.05);}.e{color:#007bff;text-decoration:none;font-size:1.0em;font-weight:bold;transition:all 0.3s;padding:8px 12px;border-radius:6px;background:rgba(0,123,255,0.1);}.e:hover{background:rgba(0,123,255,0.2);transform:scale(1.05);}.f{background:#f8f9fa;padding:5px 20px;border-bottom:1px solid #e9ecef;text-align:center;font-size:0.9em;color:black;}.f #connectionText{font-weight:bold;}.g{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;text-align:center;padding:15px 20px;width:100%;font-size:0.9em;border-top:1px solid rgba(255,255,255,0.1);position:fixed;bottom:0;left:0;z-index:1000;height:40px;box-sizing:border-box;display:flex;align-items:center;justify-content:center;}.g a{color:white;text-decoration:none;font-weight:bold;transition:all 0.3s ease;}.g a:hover{color:rgba(255,255,255,0.8);text-decoration:underline;}.h{position:absolute;top:50%;right:25px;transform:translateY(-50%);text-align:right;}.i{padding:8px 16px;border-radius:20px;font-size:0.9em;font-weight:bold;margin-bottom:5px;}.j{padding:30px;}.k{text-align:center;margin-bottom:30px;}.l{background:#f8f9fa;border:2px solid #e9ecef;border-radius:15px;padding:30px;margin-bottom:20px;display:inline-block;}.m{border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,0.1);}.n{background:#f8f9fa;border:2px solid #e9ecef;border-radius:15px;padding:20px;margin-bottom:20px;}.o{display:flex;flex-direction:row;gap:8px;margin-bottom:8px;justify-content:center;}.p{background:white;border:1px solid #e9ecef;border-radius:6px;padding:4px 8px;text-align:center;}.q{font-size:0.95em;font-weight:500;color:#FF0000;padding:2px 8px;}.r{font-size:0.9em;color:#666;margin-bottom:5px;}.s{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;padding:12px 24px;border-radius:10px;font-size:1em;font-weight:bold;cursor:pointer;transition:all 0.3s ease;margin:5px;}.s:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(102,126,234,0.4);}.s:active{transform:translateY(0);}.t{display:flex;align-items:center;justify-content:center;margin:15px 0;font-size:1.1em;color:#333;}.t input[type=checkbox]{width:20px;height:20px;margin-right:10px;cursor:pointer;}.u{background:linear-gradient(135deg,rgba(102,126,234,0.1) 0%,rgba(118,75,162,0.1) 100%);border:1px solid rgba(102,126,234,0.2);border-radius:15px;padding:20px;margin-bottom:20px;}.u h3{color:#667eea;margin-bottom:10px;}.u p{color:#666;line-height:1.5;}.v{background:#f8f9fa;padding:20px;border-top:1px solid #e9ecef;text-align:center;}.w{background:white;color:#667eea;border:2px solid #667eea;text-decoration:none;padding:10px 20px;border-radius:10px;font-weight:bold;margin:5px;display:inline-block;transition:all 0.3s ease;}.w:hover{background:#667eea;color:white;transform:translateY(-2px);}@media (max-width:768px){body{padding-bottom:50px;}.b{padding:20px 15px;}.b h1{font-size:1.5em;}.h{position:static;transform:none;text-align:center;margin-top:15px;}.g{height:50px;padding:10px 15px;font-size:0.8em;}.j{padding:20px 15px;}.o{grid-template-columns:1fr;}.l{padding:20px;}.v{padding:15px;}.w{display:block;margin:10px auto;width:90%;max-width:300px;}}@media (max-width:480px){.b h1{font-size:1.3em;}.b p{font-size:1em;}}#joystick{border-radius:50%;box-shadow:0 10px 30px rgba(0,0,0,0.4);margin:20px auto;display:block;}.x{display:flex;justify-content:center;align-items:center;gap:20px;flex-wrap:wrap;margin:20px 0;}button{font-weight:bold;font-size:1.2em;padding:12px 24px;border:none;border-radius:25px;background:linear-gradient(45deg,#ff6b6b,#ee5a24);color:white;cursor:pointer;transition:all 0.3s ease;box-shadow:0 4px 15px rgba(0,0,0,0.2);}button:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,0.3);}button:active{transform:translateY(0);}.y{background:rgba(255,255,255,0.2);border-radius:15px;padding:15px;margin:20px 0;backdrop-filter:blur(5px);}.z{display:flex;justify-content:center;gap:30px;margin:20px 0;flex-wrap:wrap;}.A{background:rgba(255,255,255,0.2);border-radius:10px;padding:15px 25px;backdrop-filter:blur(5px);min-width:80px;}.r{font-size:0.9em;opacity:0.8;margin-bottom:5px;}.B{font-size:2em;font-weight:bold;color:#ffd700;}.v{margin-top:30px;}.w{background:linear-gradient(45deg,#4ecdc4,#44a08d);margin:0 10px;text-decoration:none;display:inline-block;}.w:hover{background:linear-gradient(45deg,#44a08d,#4ecdc4);}@media (max-width:768px){h1{font-size:2em;}.z{gap:15px;}.A{padding:10px 15px;min-width:60px;}.B{font-size:1.5em;}button{font-size:1em;padding:10px 20px;}}@media (min-width:769px) and (max-width:1023px){.a{padding:15px;}h1{font-size:2.2em;}}@media (min-width:1024px){.a{padding:25px;}h1{font-size:3em;}.l{padding:40px;}}</style><script>var O=400,P=400;var Q=120;var R=50;var S=80;var T=O/2-10;var U=12;var V=400,W=400;var X=120;var Y=50;var Z=80;var a0=V/2-10;var a1=12;var a2;var a3={x:0,y:0};var a4=0;var a5=1;var a6=0;var a7=50;var a8=0;var a9=false;var b0={autoReturn:false,sensitivity:1.0};var b1={x:0,y:0};function C(){var b2=window.innerWidth;var b3=window.innerHeight;if(b2<b3){a5=Math.min((b2-100)/V,0.8);}else{a5=Math.min((b3-200)/V,0.8);}O=Math.round(V*a5);P=Math.round(W*a5);Q=Math.round(X*a5);R=Math.round(Y*a5);S=Math.round(Z*a5);T=Math.round(a0*a5);U=Math.round(a1*a5);var b4=document.getElementById("joystick");b4.width=O;b4.height=P;if(!b4.hasAttribute('data-events-added')){b4.addEventListener("touchstart",J,{passive:false});b4.addEventListener("touchend",K,{passive:false});b4.addEventListener("touchmove",L,{passive:false});b4.addEventListener("mousedown",J);b4.addEventListener("mouseup",K);b4.addEventListener("mousemove",L);b4.addEventListener("mouseleave",K);b4.setAttribute('data-events-added','true');}var b5=b4.getContext("2d");b5.setTransform(1,0,0,1,0,0);b5.translate(O/2,P/2);b5.shadowBlur=10;b5.shadowColor="LightGray";b5.lineCap="round";b5.lineJoin="round";H();}function D(b6){const b7=document.getElementById('connectionText');b7.textContent=b6;console.log('WebSocket '+b6);if(b6=='connected')b7.style.color='#007bff';else if(b6=='connecting')b7.style.color='#6c757d';else b7.style.color='#dc3545';}function E(){if(a2&&a2.readyState===WebSocket.OPEN){return;}if(a9){return;}a9=true;var b8=window.location.protocol==='https:'?'wss:':'ws:';var b9=b8+'//'+window.location.host+':81';a2=new WebSocket(b9);document.getElementById("connectionText").innerHTML="Connecting...";a2.onopen=function(){a9=false;D('connected');a2.send('JOYSTICK:GET_CONFIG');console.log("Requesting initial joystick configuration...");setTimeout(function(){a2.send('JOYSTICK:GET_VALUES');console.log("Requesting current joystick c5...");},100);};a2.onclose=function(){D('disconnected');a2=null;a9=false;setTimeout(function(){E();},3000);};a2.onerror=function(error){console.error("WebSocket error:",error);var c0=document.getElementById("connectionStatus");c0.innerHTML="Error";c0.className="i disconnected";a9=false;setTimeout(function(){E();},3000);};a2.onmessage=function(e5){console.log("Received:",e5.data);F(e5.data);};}function F(c1){if(c1.startsWith('JOYSTICK_CONFIG:')){const c2=c1.substring(16);try{const c3=JSON.parse(c2);console.log("Received joystick configuration:",c3);if(c3.hasOwnProperty('autoReturn')){b0.autoReturn=c3.autoReturn;document.getElementById("auto_return").textContent=c3.autoReturn?"ON":"OFF";console.log("Auto-return set to:",c3.autoReturn);}if(c3.hasOwnProperty('sensitivity')){b0.sensitivity=c3.sensitivity;document.getElementById("sensitivity").textContent=c3.sensitivity.toFixed(1);console.log("Joystick sensitivity set to:",c3.sensitivity);}}catch(e){console.error('Error parsing joystick configuration:',e);}return;}if(c1.startsWith('JOYSTICK:')){const c4=c1.substring(9);const c5=c4.split(',');if(c5.length===2){const x=parseInt(c5[0]);const y=parseInt(c5[1]);if(!isNaN(x)&&!isNaN(y)){N(x,y);console.log('Joystick position updated from Arduino:X='+x+',Y='+y);}}return;}console.log("Unhandled joystick c1:",c1);}function G(){var c6=Date.now();if(c6-a6<a7){return;}var x=a3.x,y=a3.y;var c7=T-R;var c8=Math.round(x*100/c7);var c9=Math.round(-y*100/c7);var d0=Math.abs(c8-b1.x);var d1=Math.abs(c9-b1.y);if(d0<b0.sensitivity&&d1<b0.sensitivity){return;}a6=c6;b1.x=c8;b1.y=c9;document.getElementById("x_value").textContent=c8;document.getElementById("y_value").textContent=c9;if(a2&&a2.readyState===WebSocket.OPEN){var d2="JOYSTICK:"+c8+","+c9;a2.send(d2);console.log("Sent to Arduino-Values:",c8+","+c9,"|Change:",d0.toFixed(1)+","+d1.toFixed(1),"|Sensitivity threshold:",b0.sensitivity);}}function H(){var x=a3.x,y=a3.y;var b4=document.getElementById("joystick");var b5=b4.getContext("2d");b5.clearRect(-O/2,-P/2,O,P);b5.lineWidth=3;b5.strokeStyle="gray";b5.fillStyle="LightGray";b5.beginPath();b5.arc(0,0,T,0,2*Math.PI);b5.stroke();b5.fill();b5.strokeStyle="black";b5.fillStyle="hsl(0,0%,35%)";b5.beginPath();b5.arc(0,0,Q,0,2*Math.PI);b5.stroke();b5.fill();b5.strokeStyle="red";var d3=S;var d4=0,d5=0;var d6=x/5;var d7=y/5;var d8=(S-10)/U;var d9=1;while(d3>=10){var e0=Math.round(d9*d6/d8);var e1=Math.round(d9*d7/d8);b5.lineWidth=d3;b5.beginPath();b5.lineTo(d4,d5);b5.lineTo(e0,e1);b5.stroke();d3-=U;d4=e0;d5=e1;d9++;}var e2=Math.round(x/3);var e3=Math.round(y/3);d3+=U;b5.beginPath();b5.lineTo(d4,d5);b5.lineTo(e2,e3);b5.stroke();d9=1;d4=e2;d5=e3;while(d3<S){var e0=Math.round(e2+d9*(x-e2)/d8);var e1=Math.round(e3+d9*(y-e3)/d8);b5.lineWidth=d3;b5.beginPath();b5.lineTo(d4,d5);b5.lineTo(e0,e1);b5.stroke();d3+=U;d4=e0;d5=e1;d9++;}var e4=b5.createRadialGradient(x,y,0,x,y,R);for(var i=85;i>=50;i-=5)e4.addColorStop((85-i)/35,"hsl(0,100%,"+i+"%)");b5.fillStyle=e4;b5.beginPath();b5.arc(x,y,R,0,2*Math.PI);b5.fill();}function I(e5){var e6=e5.target.getBoundingClientRect();var e7,e8;if(e5.touches&&e5.touches.length>0){e7=(e5.touches[0].clientX-e6.left)-O/2;e8=(e5.touches[0].clientY-e6.top)-P/2;}else{e7=(e5.clientX-e6.left)-O/2;e8=(e5.clientY-e6.top)-P/2;}return{x:e7,y:e8};}function J(e5){e5.preventDefault();var e9=I(e5);var f0=Math.sqrt(e9.x*e9.x+e9.y*e9.y);if(f0>T)return;var f1=e9.x-a3.x;var f2=e9.y-a3.y;var f3=Math.sqrt(f1*f1+f2*f2);if(f3>R)return;a4=1;}function K(e5){if(e5) e5.preventDefault();if(a4){a4=0;if(b0.autoReturn){var f4=10;var f5=a3.x/f4;var f6=a3.y/f4;var f7=0;var f8=setInterval(function(){f7++;a3.x-=f5;a3.y-=f6;if(f7>=f4){a3.x=0;a3.y=0;clearInterval(f8);}G();H();},20);}}}function L(e5){e5.preventDefault();if(!a4)return;var e9=I(e5);var f0=Math.sqrt(e9.x*e9.x+e9.y*e9.y);if(b0.autoReturn){if(f0<(T-R)){a3=e9;G();H();}}else{if(f0<(T-R)){a3=e9;}else{var f9=Math.atan2(e9.y,e9.x);var g0=T-R;a3.x=Math.cos(f9)*g0;a3.y=Math.sin(f9)*g0;}G();H();}}function M(){a3.x=0;a3.y=0;G();H();}function N(x,y){var c7=T-R;x=Math.max(-100,Math.min(100,x));y=Math.max(-100,Math.min(100,y));var g1=Math.round(x*c7/100);var g2=Math.round(-y*c7/100);var f0=Math.sqrt(g1*g1+g2*g2);if(f0>c7){var f9=Math.atan2(g2,g1);g1=Math.cos(f9)*c7;g2=Math.sin(f9)*c7;}a3.x=g1;a3.y=g2;var g3=Math.round(g1*100/c7);var g4=Math.round(-g2*100/c7);document.getElementById("x_value").textContent=g3;document.getElementById("y_value").textContent=g4;H();}window.onload=function(){C();H();setTimeout(E,100);};window.onresize=function(){var g5=Date.now();if(g5-a8>200){a8=g5;setTimeout(function(){C();H();if(!a2||a2.readyState!==WebSocket.OPEN){E();}},100);}};</script></head><body><div class="a"><div class="c"><a href="/" class="d">üè† Home</a><a href="https://diyables.io/webapps-r4" class="e" target="_blank">üìö Tutorial</a></div><div class="f" id="websocketStatus">WebSocket:<span id="connectionText">Disconnected</span></div><div class="b"><h1>üïπÔ∏è Web Joystick Control</h1><p>Interactive joystick for remote Arduino control</p></div><div class="j" style="flex:1;"><div class="k"><div class="l"><canvas id="joystick" class="m"></b4></div><div class="n"><div class="o"><div class="p"><div class="r">X Position</div><div class="q" id="x_value">0</div></div><div class="p"><div class="r">Y Position</div><div class="q" id="y_value">0</div></div></div><div style="display:flex;justify-content:center;gap:15px;margin:10px 0;font-size:0.85em;"><span style="color:#666;">Config:</span><span style="color:#667eea;">Auto Return:<strong id="auto_return">---</strong></span><span style="color:#667eea;">Sensitivity:<strong id="sensitivity">---</strong></span></div></div></div></div><div class="g">Created by&nbsp;<a href="https://diyables.io/" target="_blank">DIYables</a></div></div></body></html>)RAWSTRING";

#endif
